<?php
// This script and data application were generated by AppGini 22.14
// Download AppGini for free from https://bigprof.com/appgini/download/

	/* Configuration */
	/*************************************/

		$pcConfig = [
			'invoice' => [
				'client' => [
					'parent-table' => 'clients',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Invoices <span class="hidden child-label-invoice child-field-caption">(Client)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/attributes_display.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [1 => 'Code', 2 => 'Status', 3 => 'Date due', 4 => 'Client', 5 => 'Client contact', 7 => 'Client phone', 14 => 'Total'],
					'display-field-names' => [1 => 'code', 2 => 'status', 3 => 'date_due', 4 => 'client', 5 => 'client_contact', 7 => 'client_phone', 14 => 'total'],
					'sortable-fields' => [0 => '`invoice`.`id`', 1 => 2, 2 => 3, 3 => '`invoice`.`date_due`', 4 => '`clients1`.`name`', 5 => '`clients1`.`contact`', 6 => '`clients1`.`address`', 7 => '`clients1`.`phone`', 8 => '`clients1`.`email`', 9 => '`clients1`.`website`', 10 => '`clients1`.`comments`', 11 => '`invoice`.`subtotal`', 12 => '`invoice`.`discount`', 13 => '`invoice`.`tax`', 14 => '`invoice`.`total`', 15 => 16, 16 => 17, 17 => 18, 18 => 19],
					'records-per-page' => 10,
					'default-sort-by' => 1,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-invoice',
					'template-printable' => 'children-invoice-printable',
					'query' => "SELECT `invoice`.`id` as 'id', `invoice`.`code` as 'code', `invoice`.`status` as 'status', if(`invoice`.`date_due`,date_format(`invoice`.`date_due`,'%d/%m/%Y'),'') as 'date_due', IF(    CHAR_LENGTH(`clients1`.`name`), CONCAT_WS('',   `clients1`.`name`), '') as 'client', IF(    CHAR_LENGTH(`clients1`.`contact`), CONCAT_WS('',   `clients1`.`contact`), '') as 'client_contact', IF(    CHAR_LENGTH(`clients1`.`address`), CONCAT_WS('',   `clients1`.`address`), '') as 'client_address', IF(    CHAR_LENGTH(`clients1`.`phone`), CONCAT_WS('',   `clients1`.`phone`), '') as 'client_phone', IF(    CHAR_LENGTH(`clients1`.`email`), CONCAT_WS('',   `clients1`.`email`), '') as 'client_email', IF(    CHAR_LENGTH(`clients1`.`website`), CONCAT_WS('',   `clients1`.`website`), '') as 'client_website', IF(    CHAR_LENGTH(`clients1`.`comments`), CONCAT_WS('',   `clients1`.`comments`), '') as 'client_comments', `invoice`.`subtotal` as 'subtotal', `invoice`.`discount` as 'discount', FORMAT(`invoice`.`tax`, 2) as 'tax', `invoice`.`total` as 'total', `invoice`.`comments` as 'comments', `invoice`.`invoice_template` as 'invoice_template', `invoice`.`created` as 'created', `invoice`.`last_updated` as 'last_updated' FROM `invoice` LEFT JOIN `clients` as clients1 ON `clients1`.`id`=`invoice`.`client` "
				],
			],
			'clients' => [
			],
			'item_prices' => [
				'item' => [
					'parent-table' => 'items',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Price history <span class="hidden child-label-item_prices child-field-caption">(Item)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/card_money.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [1 => 'Item', 2 => 'Price', 3 => 'Date'],
					'display-field-names' => [1 => 'item', 2 => 'price', 3 => 'date'],
					'sortable-fields' => [0 => '`item_prices`.`id`', 1 => '`items1`.`item_description`', 2 => '`item_prices`.`price`', 3 => '`item_prices`.`date`'],
					'records-per-page' => 10,
					'default-sort-by' => 3,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-item_prices',
					'template-printable' => 'children-item_prices-printable',
					'query' => "SELECT `item_prices`.`id` as 'id', IF(    CHAR_LENGTH(`items1`.`item_description`), CONCAT_WS('',   `items1`.`item_description`), '') as 'item', `item_prices`.`price` as 'price', if(`item_prices`.`date`,date_format(`item_prices`.`date`,'%d/%m/%Y'),'') as 'date' FROM `item_prices` LEFT JOIN `items` as items1 ON `items1`.`id`=`item_prices`.`item` "
				],
			],
			'invoice_items' => [
				'invoice' => [
					'parent-table' => 'invoice',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Invoice items <span class="hidden child-label-invoice_items child-field-caption">(Invoice)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/barcode.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [2 => 'Item', 5 => 'Unit price', 6 => 'Qty', 7 => 'Price'],
					'display-field-names' => [2 => 'item', 5 => 'unit_price', 6 => 'qty', 7 => 'price'],
					'sortable-fields' => [0 => '`invoice_items`.`id`', 1 => '`invoice1`.`code`', 2 => '`items1`.`item_description`', 3 => '`items1`.`unit_price`', 4 => '`invoice_items`.`catalog_price`', 5 => '`invoice_items`.`unit_price`', 6 => '`invoice_items`.`qty`', 7 => '`invoice_items`.`price`'],
					'records-per-page' => 10,
					'default-sort-by' => 0,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-invoice_items',
					'template-printable' => 'children-invoice_items-printable',
					'query' => "SELECT `invoice_items`.`id` as 'id', IF(    CHAR_LENGTH(`invoice1`.`code`), CONCAT_WS('',   `invoice1`.`code`), '') as 'invoice', IF(    CHAR_LENGTH(`items1`.`item_description`), CONCAT_WS('',   `items1`.`item_description`), '') as 'item', IF(    CHAR_LENGTH(`items1`.`unit_price`), CONCAT_WS('',   `items1`.`unit_price`), '') as 'current_price', `invoice_items`.`catalog_price` as 'catalog_price', FORMAT(`invoice_items`.`unit_price`, 2) as 'unit_price', FORMAT(`invoice_items`.`qty`, 3) as 'qty', `invoice_items`.`price` as 'price' FROM `invoice_items` LEFT JOIN `invoice` as invoice1 ON `invoice1`.`id`=`invoice_items`.`invoice` LEFT JOIN `items` as items1 ON `items1`.`id`=`invoice_items`.`item` "
				],
				'item' => [
					'parent-table' => 'items',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Invoice items <span class="hidden child-label-invoice_items child-field-caption">(Item)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/barcode.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [2 => 'Item', 5 => 'Unit price', 6 => 'Qty', 7 => 'Price'],
					'display-field-names' => [2 => 'item', 5 => 'unit_price', 6 => 'qty', 7 => 'price'],
					'sortable-fields' => [0 => '`invoice_items`.`id`', 1 => '`invoice1`.`code`', 2 => '`items1`.`item_description`', 3 => '`items1`.`unit_price`', 4 => '`invoice_items`.`catalog_price`', 5 => '`invoice_items`.`unit_price`', 6 => '`invoice_items`.`qty`', 7 => '`invoice_items`.`price`'],
					'records-per-page' => 10,
					'default-sort-by' => 0,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-invoice_items',
					'template-printable' => 'children-invoice_items-printable',
					'query' => "SELECT `invoice_items`.`id` as 'id', IF(    CHAR_LENGTH(`invoice1`.`code`), CONCAT_WS('',   `invoice1`.`code`), '') as 'invoice', IF(    CHAR_LENGTH(`items1`.`item_description`), CONCAT_WS('',   `items1`.`item_description`), '') as 'item', IF(    CHAR_LENGTH(`items1`.`unit_price`), CONCAT_WS('',   `items1`.`unit_price`), '') as 'current_price', `invoice_items`.`catalog_price` as 'catalog_price', FORMAT(`invoice_items`.`unit_price`, 2) as 'unit_price', FORMAT(`invoice_items`.`qty`, 3) as 'qty', `invoice_items`.`price` as 'price' FROM `invoice_items` LEFT JOIN `invoice` as invoice1 ON `invoice1`.`id`=`invoice_items`.`invoice` LEFT JOIN `items` as items1 ON `items1`.`id`=`invoice_items`.`item` "
				],
			],
			'items' => [
			],
			'workorders' => [
				'wo_assignedto' => [
					'parent-table' => 'techs',
					'parent-primary-key' => 'techID',
					'child-primary-key' => 'wo_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Work Orders <span class="hidden child-label-workorders child-field-caption">(Assigned to Tech)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [0 => 'Work Order ID', 1 => 'Created By', 2 => 'Date Created', 3 => 'Status', 4 => 'Assigned to Tech', 5 => 'Client', 6 => 'Ticket/Reference Number', 7 => 'Client Asset/Device', 8 => 'Title'],
					'display-field-names' => [0 => 'wo_ID', 1 => 'wo_createdby', 2 => 'wo_datecreated', 3 => 'wo_Status', 4 => 'wo_assignedto', 5 => 'wo_client', 6 => 'wo_ticket', 7 => 'wo_asset', 8 => 'wo_Title'],
					'sortable-fields' => [0 => '`workorders`.`wo_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => 7, 7 => 8, 8 => 9, 9 => 10],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-workorders',
					'template-printable' => 'children-workorders-printable',
					'query' => "SELECT `workorders`.`wo_ID` as 'wo_ID', if(CHAR_LENGTH(`workorders`.`wo_createdby`)>64, concat(left(`workorders`.`wo_createdby`,64),' ...'), `workorders`.`wo_createdby`) as 'wo_createdby', if(CHAR_LENGTH(`workorders`.`wo_datecreated`)>64, concat(left(`workorders`.`wo_datecreated`,64),' ...'), `workorders`.`wo_datecreated`) as 'wo_datecreated', if(CHAR_LENGTH(`workorders`.`wo_Status`)>64, concat(left(`workorders`.`wo_Status`,64),' ...'), `workorders`.`wo_Status`) as 'wo_Status', IF(    CHAR_LENGTH(`techs1`.`techID`) || CHAR_LENGTH(`techs1`.`techName`), CONCAT_WS('',   `techs1`.`techID`, ' - ', `techs1`.`techName`), '') as 'wo_assignedto', IF(    CHAR_LENGTH(`clients1`.`id`) || CHAR_LENGTH(`clients1`.`name`), CONCAT_WS('',   `clients1`.`id`, ' - ', `clients1`.`name`), '') as 'wo_client', if(CHAR_LENGTH(`workorders`.`wo_ticket`)>64, concat(left(`workorders`.`wo_ticket`,64),' ...'), `workorders`.`wo_ticket`) as 'wo_ticket', IF(    CHAR_LENGTH(`clients2`.`id`) || CHAR_LENGTH(`clients2`.`name`) || CHAR_LENGTH(`assets1`.`asset_serial`), CONCAT_WS('',   `clients2`.`id`, ' - ', `clients2`.`name`, ' - ', `assets1`.`asset_serial`), '') as 'wo_asset', if(CHAR_LENGTH(`workorders`.`wo_Title`)>128, concat(left(`workorders`.`wo_Title`,128),' ...'), `workorders`.`wo_Title`) as 'wo_Title', if(CHAR_LENGTH(`workorders`.`wo_Description`)>128, concat(left(`workorders`.`wo_Description`,128),' ...'), `workorders`.`wo_Description`) as 'wo_Description' FROM `workorders` LEFT JOIN `techs` as techs1 ON `techs1`.`techID`=`workorders`.`wo_assignedto` LEFT JOIN `clients` as clients1 ON `clients1`.`id`=`workorders`.`wo_client` LEFT JOIN `assets` as assets1 ON `assets1`.`asset_ID`=`workorders`.`wo_asset` LEFT JOIN `clients` as clients2 ON `clients2`.`id`=`assets1`.`asset_client` "
				],
				'wo_client' => [
					'parent-table' => 'clients',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'wo_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Work Orders <span class="hidden child-label-workorders child-field-caption">(Client)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [0 => 'Work Order ID', 1 => 'Created By', 2 => 'Date Created', 3 => 'Status', 4 => 'Assigned to Tech', 5 => 'Client', 6 => 'Ticket/Reference Number', 7 => 'Client Asset/Device', 8 => 'Title'],
					'display-field-names' => [0 => 'wo_ID', 1 => 'wo_createdby', 2 => 'wo_datecreated', 3 => 'wo_Status', 4 => 'wo_assignedto', 5 => 'wo_client', 6 => 'wo_ticket', 7 => 'wo_asset', 8 => 'wo_Title'],
					'sortable-fields' => [0 => '`workorders`.`wo_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => 7, 7 => 8, 8 => 9, 9 => 10],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-workorders',
					'template-printable' => 'children-workorders-printable',
					'query' => "SELECT `workorders`.`wo_ID` as 'wo_ID', if(CHAR_LENGTH(`workorders`.`wo_createdby`)>64, concat(left(`workorders`.`wo_createdby`,64),' ...'), `workorders`.`wo_createdby`) as 'wo_createdby', if(CHAR_LENGTH(`workorders`.`wo_datecreated`)>64, concat(left(`workorders`.`wo_datecreated`,64),' ...'), `workorders`.`wo_datecreated`) as 'wo_datecreated', if(CHAR_LENGTH(`workorders`.`wo_Status`)>64, concat(left(`workorders`.`wo_Status`,64),' ...'), `workorders`.`wo_Status`) as 'wo_Status', IF(    CHAR_LENGTH(`techs1`.`techID`) || CHAR_LENGTH(`techs1`.`techName`), CONCAT_WS('',   `techs1`.`techID`, ' - ', `techs1`.`techName`), '') as 'wo_assignedto', IF(    CHAR_LENGTH(`clients1`.`id`) || CHAR_LENGTH(`clients1`.`name`), CONCAT_WS('',   `clients1`.`id`, ' - ', `clients1`.`name`), '') as 'wo_client', if(CHAR_LENGTH(`workorders`.`wo_ticket`)>64, concat(left(`workorders`.`wo_ticket`,64),' ...'), `workorders`.`wo_ticket`) as 'wo_ticket', IF(    CHAR_LENGTH(`clients2`.`id`) || CHAR_LENGTH(`clients2`.`name`) || CHAR_LENGTH(`assets1`.`asset_serial`), CONCAT_WS('',   `clients2`.`id`, ' - ', `clients2`.`name`, ' - ', `assets1`.`asset_serial`), '') as 'wo_asset', if(CHAR_LENGTH(`workorders`.`wo_Title`)>128, concat(left(`workorders`.`wo_Title`,128),' ...'), `workorders`.`wo_Title`) as 'wo_Title', if(CHAR_LENGTH(`workorders`.`wo_Description`)>128, concat(left(`workorders`.`wo_Description`,128),' ...'), `workorders`.`wo_Description`) as 'wo_Description' FROM `workorders` LEFT JOIN `techs` as techs1 ON `techs1`.`techID`=`workorders`.`wo_assignedto` LEFT JOIN `clients` as clients1 ON `clients1`.`id`=`workorders`.`wo_client` LEFT JOIN `assets` as assets1 ON `assets1`.`asset_ID`=`workorders`.`wo_asset` LEFT JOIN `clients` as clients2 ON `clients2`.`id`=`assets1`.`asset_client` "
				],
				'wo_asset' => [
					'parent-table' => 'assets',
					'parent-primary-key' => 'asset_ID',
					'child-primary-key' => 'wo_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Work Orders <span class="hidden child-label-workorders child-field-caption">(Client Asset/Device)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [0 => 'Work Order ID', 1 => 'Created By', 2 => 'Date Created', 3 => 'Status', 4 => 'Assigned to Tech', 5 => 'Client', 6 => 'Ticket/Reference Number', 7 => 'Client Asset/Device', 8 => 'Title'],
					'display-field-names' => [0 => 'wo_ID', 1 => 'wo_createdby', 2 => 'wo_datecreated', 3 => 'wo_Status', 4 => 'wo_assignedto', 5 => 'wo_client', 6 => 'wo_ticket', 7 => 'wo_asset', 8 => 'wo_Title'],
					'sortable-fields' => [0 => '`workorders`.`wo_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => 7, 7 => 8, 8 => 9, 9 => 10],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-workorders',
					'template-printable' => 'children-workorders-printable',
					'query' => "SELECT `workorders`.`wo_ID` as 'wo_ID', if(CHAR_LENGTH(`workorders`.`wo_createdby`)>64, concat(left(`workorders`.`wo_createdby`,64),' ...'), `workorders`.`wo_createdby`) as 'wo_createdby', if(CHAR_LENGTH(`workorders`.`wo_datecreated`)>64, concat(left(`workorders`.`wo_datecreated`,64),' ...'), `workorders`.`wo_datecreated`) as 'wo_datecreated', if(CHAR_LENGTH(`workorders`.`wo_Status`)>64, concat(left(`workorders`.`wo_Status`,64),' ...'), `workorders`.`wo_Status`) as 'wo_Status', IF(    CHAR_LENGTH(`techs1`.`techID`) || CHAR_LENGTH(`techs1`.`techName`), CONCAT_WS('',   `techs1`.`techID`, ' - ', `techs1`.`techName`), '') as 'wo_assignedto', IF(    CHAR_LENGTH(`clients1`.`id`) || CHAR_LENGTH(`clients1`.`name`), CONCAT_WS('',   `clients1`.`id`, ' - ', `clients1`.`name`), '') as 'wo_client', if(CHAR_LENGTH(`workorders`.`wo_ticket`)>64, concat(left(`workorders`.`wo_ticket`,64),' ...'), `workorders`.`wo_ticket`) as 'wo_ticket', IF(    CHAR_LENGTH(`clients2`.`id`) || CHAR_LENGTH(`clients2`.`name`) || CHAR_LENGTH(`assets1`.`asset_serial`), CONCAT_WS('',   `clients2`.`id`, ' - ', `clients2`.`name`, ' - ', `assets1`.`asset_serial`), '') as 'wo_asset', if(CHAR_LENGTH(`workorders`.`wo_Title`)>128, concat(left(`workorders`.`wo_Title`,128),' ...'), `workorders`.`wo_Title`) as 'wo_Title', if(CHAR_LENGTH(`workorders`.`wo_Description`)>128, concat(left(`workorders`.`wo_Description`,128),' ...'), `workorders`.`wo_Description`) as 'wo_Description' FROM `workorders` LEFT JOIN `techs` as techs1 ON `techs1`.`techID`=`workorders`.`wo_assignedto` LEFT JOIN `clients` as clients1 ON `clients1`.`id`=`workorders`.`wo_client` LEFT JOIN `assets` as assets1 ON `assets1`.`asset_ID`=`workorders`.`wo_asset` LEFT JOIN `clients` as clients2 ON `clients2`.`id`=`assets1`.`asset_client` "
				],
			],
			'techs' => [
			],
			'assets' => [
				'asset_client' => [
					'parent-table' => 'clients',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'asset_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Assets <span class="hidden child-label-assets child-field-caption">(Client Owner)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [0 => 'Asset ID', 1 => 'Client Owner', 2 => 'Asset type', 3 => 'Manufacturer', 4 => 'Asset model', 5 => 'Serial Number', 6 => 'Asset IMEI'],
					'display-field-names' => [0 => 'asset_ID', 1 => 'asset_client', 2 => 'asset_type', 3 => 'asset_mfr', 4 => 'asset_model', 5 => 'asset_serial', 6 => 'asset_IMEI'],
					'sortable-fields' => [0 => '`assets`.`asset_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => 7],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-assets',
					'template-printable' => 'children-assets-printable',
					'query' => "SELECT `assets`.`asset_ID` as 'asset_ID', IF(    CHAR_LENGTH(`clients1`.`id`) || CHAR_LENGTH(`clients1`.`name`), CONCAT_WS('',   `clients1`.`id`, ' - ', `clients1`.`name`), '') as 'asset_client', `assets`.`asset_type` as 'asset_type', `assets`.`asset_mfr` as 'asset_mfr', `assets`.`asset_model` as 'asset_model', `assets`.`asset_serial` as 'asset_serial', `assets`.`asset_IMEI` as 'asset_IMEI' FROM `assets` LEFT JOIN `clients` as clients1 ON `clients1`.`id`=`assets`.`asset_client` "
				],
			],
			'workordernotes' => [
				'wonote_wo' => [
					'parent-table' => 'workorders',
					'parent-primary-key' => 'wo_ID',
					'child-primary-key' => 'wonote_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Workordernotes <span class="hidden child-label-workordernotes child-field-caption">(Work Order)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [1 => 'Work Order', 2 => 'Wonote note', 3 => 'Wonote author', 4 => 'Wonote timestamp', 5 => 'Wonote editor', 6 => 'Wonote editorts'],
					'display-field-names' => [1 => 'wonote_wo', 2 => 'wonote_note', 3 => 'wonote_author', 4 => 'wonote_timestamp', 5 => 'wonote_editor', 6 => 'wonote_editorts'],
					'sortable-fields' => [0 => '`workordernotes`.`wonote_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => 7],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-workordernotes',
					'template-printable' => 'children-workordernotes-printable',
					'query' => "SELECT `workordernotes`.`wonote_ID` as 'wonote_ID', IF(    CHAR_LENGTH(`workorders1`.`wo_ID`) || CHAR_LENGTH(`workorders1`.`wo_Title`), CONCAT_WS('',   `workorders1`.`wo_ID`, ' - ', `workorders1`.`wo_Title`), '') as 'wonote_wo', `workordernotes`.`wonote_note` as 'wonote_note', `workordernotes`.`wonote_author` as 'wonote_author', `workordernotes`.`wonote_timestamp` as 'wonote_timestamp', `workordernotes`.`wonote_editor` as 'wonote_editor', `workordernotes`.`wonote_editorts` as 'wonote_editorts' FROM `workordernotes` LEFT JOIN `workorders` as workorders1 ON `workorders1`.`wo_ID`=`workordernotes`.`wonote_wo` "
				],
			],
			'technotes' => [
				'technote_tech' => [
					'parent-table' => 'techs',
					'parent-primary-key' => 'techID',
					'child-primary-key' => 'technote_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Technician Notes <span class="hidden child-label-technotes child-field-caption">(Technote tech)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [0 => 'Technote ID', 1 => 'Technote tech', 2 => 'Technote note', 3 => 'Technote author', 4 => 'Technote timestamp', 5 => 'Technote editor', 6 => 'Technote editorts'],
					'display-field-names' => [0 => 'technote_ID', 1 => 'technote_tech', 2 => 'technote_note', 3 => 'technote_author', 4 => 'technote_timestamp', 5 => 'technote_editor', 6 => 'technote_editorts'],
					'sortable-fields' => [0 => '`technotes`.`technote_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => 7],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-technotes',
					'template-printable' => 'children-technotes-printable',
					'query' => "SELECT `technotes`.`technote_ID` as 'technote_ID', IF(    CHAR_LENGTH(`techs1`.`techID`) || CHAR_LENGTH(`techs1`.`techName`), CONCAT_WS('',   `techs1`.`techID`, ' - ', `techs1`.`techName`), '') as 'technote_tech', `technotes`.`technote_note` as 'technote_note', `technotes`.`technote_author` as 'technote_author', `technotes`.`technote_timestamp` as 'technote_timestamp', `technotes`.`technote_editor` as 'technote_editor', `technotes`.`technote_editorts` as 'technote_editorts' FROM `technotes` LEFT JOIN `techs` as techs1 ON `techs1`.`techID`=`technotes`.`technote_tech` "
				],
			],
			'tblwopubstatus' => [
				'wopub_WO' => [
					'parent-table' => 'workorders',
					'parent-primary-key' => 'wo_ID',
					'child-primary-key' => 'wopub_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Work Order Status <span class="hidden child-label-tblwopubstatus child-field-caption">(Work Order)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [1 => 'Work Order', 2 => 'Updated:', 3 => 'Status', 4 => 'Comments'],
					'display-field-names' => [1 => 'wopub_WO', 2 => 'wopub_Updated', 3 => 'wopub_status', 4 => 'wopub_Comments'],
					'sortable-fields' => [0 => '`tblwopubstatus`.`wopub_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-tblwopubstatus',
					'template-printable' => 'children-tblwopubstatus-printable',
					'query' => "SELECT `tblwopubstatus`.`wopub_ID` as 'wopub_ID', IF(    CHAR_LENGTH(`workorders1`.`wo_ID`) || CHAR_LENGTH(`workorders1`.`wo_Title`), CONCAT_WS('',   `workorders1`.`wo_ID`, ' - ', `workorders1`.`wo_Title`), '') as 'wopub_WO', `tblwopubstatus`.`wopub_Updated` as 'wopub_Updated', `tblwopubstatus`.`wopub_status` as 'wopub_status', `tblwopubstatus`.`wopub_Comments` as 'wopub_Comments' FROM `tblwopubstatus` LEFT JOIN `workorders` as workorders1 ON `workorders1`.`wo_ID`=`tblwopubstatus`.`wopub_WO` "
				],
			],
			'asset_notes' => [
				'assetnote_asset' => [
					'parent-table' => 'assets',
					'parent-primary-key' => 'asset_ID',
					'child-primary-key' => 'assetnote_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Asset notes <span class="hidden child-label-asset_notes child-field-caption">(Asset)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [0 => 'Asset Note ID', 1 => 'Asset', 2 => 'Note', 3 => 'Assetnote author', 4 => 'Assetnote timestamp', 5 => 'Assetnote editor', 6 => 'Assetnote editorts'],
					'display-field-names' => [0 => 'assetnote_ID', 1 => 'assetnote_asset', 2 => 'assetnote_note', 3 => 'assetnote_author', 4 => 'assetnote_timestamp', 5 => 'assetnote_editor', 6 => 'assetnote_editorts'],
					'sortable-fields' => [0 => '`asset_notes`.`assetnote_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => 7],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-asset_notes',
					'template-printable' => 'children-asset_notes-printable',
					'query' => "SELECT `asset_notes`.`assetnote_ID` as 'assetnote_ID', IF(    CHAR_LENGTH(`assets1`.`asset_ID`) || CHAR_LENGTH(`clients1`.`id`) || CHAR_LENGTH(`clients1`.`name`), CONCAT_WS('',   `assets1`.`asset_ID`, ' - ', `clients1`.`id`, ' - ', `clients1`.`name`), '') as 'assetnote_asset', if(CHAR_LENGTH(`asset_notes`.`assetnote_note`)>128, concat(left(`asset_notes`.`assetnote_note`,128),' ...'), `asset_notes`.`assetnote_note`) as 'assetnote_note', if(CHAR_LENGTH(`asset_notes`.`assetnote_author`)>64, concat(left(`asset_notes`.`assetnote_author`,64),' ...'), `asset_notes`.`assetnote_author`) as 'assetnote_author', if(CHAR_LENGTH(`asset_notes`.`assetnote_timestamp`)>64, concat(left(`asset_notes`.`assetnote_timestamp`,64),' ...'), `asset_notes`.`assetnote_timestamp`) as 'assetnote_timestamp', if(CHAR_LENGTH(`asset_notes`.`assetnote_editor`)>64, concat(left(`asset_notes`.`assetnote_editor`,64),' ...'), `asset_notes`.`assetnote_editor`) as 'assetnote_editor', if(CHAR_LENGTH(`asset_notes`.`assetnote_editorts`)>64, concat(left(`asset_notes`.`assetnote_editorts`,64),' ...'), `asset_notes`.`assetnote_editorts`) as 'assetnote_editorts' FROM `asset_notes` LEFT JOIN `assets` as assets1 ON `assets1`.`asset_ID`=`asset_notes`.`assetnote_asset` LEFT JOIN `clients` as clients1 ON `clients1`.`id`=`assets1`.`asset_client` "
				],
			],
			'call_logs' => [
				'call_client' => [
					'parent-table' => 'clients',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'call_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Call Logs <span class="hidden child-label-call_logs child-field-caption">(Client)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [0 => 'Call ID', 1 => 'Date/Time Logged:', 2 => 'Logged By:', 3 => 'Client', 4 => 'Related Work Order', 5 => 'Related Asset', 6 => 'Related Invoice', 7 => 'Log Entry'],
					'display-field-names' => [0 => 'call_ID', 1 => 'call_datetime', 2 => 'call_loggedby', 3 => 'call_client', 4 => 'call_workorder', 5 => 'call_asset', 6 => 'call_invoice', 7 => 'call_logentry'],
					'sortable-fields' => [0 => '`call_logs`.`call_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => 7, 7 => 8],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-call_logs',
					'template-printable' => 'children-call_logs-printable',
					'query' => "SELECT `call_logs`.`call_ID` as 'call_ID', if(CHAR_LENGTH(`call_logs`.`call_datetime`)>64, concat(left(`call_logs`.`call_datetime`,64),' ...'), `call_logs`.`call_datetime`) as 'call_datetime', if(CHAR_LENGTH(`call_logs`.`call_loggedby`)>64, concat(left(`call_logs`.`call_loggedby`,64),' ...'), `call_logs`.`call_loggedby`) as 'call_loggedby', IF(    CHAR_LENGTH(`clients1`.`id`) || CHAR_LENGTH(`clients1`.`name`), CONCAT_WS('',   `clients1`.`id`, ' : ', `clients1`.`name`), '') as 'call_client', IF(    CHAR_LENGTH(`workorders1`.`wo_ID`) || CHAR_LENGTH(`workorders1`.`wo_Title`), CONCAT_WS('',   `workorders1`.`wo_ID`, ' : ', `workorders1`.`wo_Title`), '') as 'call_workorder', IF(    CHAR_LENGTH(`assets1`.`asset_ID`) || CHAR_LENGTH(`assets1`.`asset_serial`), CONCAT_WS('',   `assets1`.`asset_ID`, ' : ', `assets1`.`asset_serial`), '') as 'call_asset', IF(    CHAR_LENGTH(`invoice1`.`id`) || CHAR_LENGTH(if(`invoice1`.`date_due`,date_format(`invoice1`.`date_due`,'%d/%m/%Y'),'')), CONCAT_WS('',   `invoice1`.`id`, ' : ', if(`invoice1`.`date_due`,date_format(`invoice1`.`date_due`,'%d/%m/%Y'),'')), '') as 'call_invoice', if(CHAR_LENGTH(`call_logs`.`call_logentry`)>64, concat(left(`call_logs`.`call_logentry`,64),' ...'), `call_logs`.`call_logentry`) as 'call_logentry' FROM `call_logs` LEFT JOIN `clients` as clients1 ON `clients1`.`id`=`call_logs`.`call_client` LEFT JOIN `workorders` as workorders1 ON `workorders1`.`wo_ID`=`call_logs`.`call_workorder` LEFT JOIN `assets` as assets1 ON `assets1`.`asset_ID`=`call_logs`.`call_asset` LEFT JOIN `invoice` as invoice1 ON `invoice1`.`id`=`call_logs`.`call_invoice` "
				],
				'call_workorder' => [
					'parent-table' => 'workorders',
					'parent-primary-key' => 'wo_ID',
					'child-primary-key' => 'call_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Call Logs <span class="hidden child-label-call_logs child-field-caption">(Related Work Order)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [0 => 'Call ID', 1 => 'Date/Time Logged:', 2 => 'Logged By:', 3 => 'Client', 4 => 'Related Work Order', 5 => 'Related Asset', 6 => 'Related Invoice', 7 => 'Log Entry'],
					'display-field-names' => [0 => 'call_ID', 1 => 'call_datetime', 2 => 'call_loggedby', 3 => 'call_client', 4 => 'call_workorder', 5 => 'call_asset', 6 => 'call_invoice', 7 => 'call_logentry'],
					'sortable-fields' => [0 => '`call_logs`.`call_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => 7, 7 => 8],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-call_logs',
					'template-printable' => 'children-call_logs-printable',
					'query' => "SELECT `call_logs`.`call_ID` as 'call_ID', if(CHAR_LENGTH(`call_logs`.`call_datetime`)>64, concat(left(`call_logs`.`call_datetime`,64),' ...'), `call_logs`.`call_datetime`) as 'call_datetime', if(CHAR_LENGTH(`call_logs`.`call_loggedby`)>64, concat(left(`call_logs`.`call_loggedby`,64),' ...'), `call_logs`.`call_loggedby`) as 'call_loggedby', IF(    CHAR_LENGTH(`clients1`.`id`) || CHAR_LENGTH(`clients1`.`name`), CONCAT_WS('',   `clients1`.`id`, ' : ', `clients1`.`name`), '') as 'call_client', IF(    CHAR_LENGTH(`workorders1`.`wo_ID`) || CHAR_LENGTH(`workorders1`.`wo_Title`), CONCAT_WS('',   `workorders1`.`wo_ID`, ' : ', `workorders1`.`wo_Title`), '') as 'call_workorder', IF(    CHAR_LENGTH(`assets1`.`asset_ID`) || CHAR_LENGTH(`assets1`.`asset_serial`), CONCAT_WS('',   `assets1`.`asset_ID`, ' : ', `assets1`.`asset_serial`), '') as 'call_asset', IF(    CHAR_LENGTH(`invoice1`.`id`) || CHAR_LENGTH(if(`invoice1`.`date_due`,date_format(`invoice1`.`date_due`,'%d/%m/%Y'),'')), CONCAT_WS('',   `invoice1`.`id`, ' : ', if(`invoice1`.`date_due`,date_format(`invoice1`.`date_due`,'%d/%m/%Y'),'')), '') as 'call_invoice', if(CHAR_LENGTH(`call_logs`.`call_logentry`)>64, concat(left(`call_logs`.`call_logentry`,64),' ...'), `call_logs`.`call_logentry`) as 'call_logentry' FROM `call_logs` LEFT JOIN `clients` as clients1 ON `clients1`.`id`=`call_logs`.`call_client` LEFT JOIN `workorders` as workorders1 ON `workorders1`.`wo_ID`=`call_logs`.`call_workorder` LEFT JOIN `assets` as assets1 ON `assets1`.`asset_ID`=`call_logs`.`call_asset` LEFT JOIN `invoice` as invoice1 ON `invoice1`.`id`=`call_logs`.`call_invoice` "
				],
				'call_asset' => [
					'parent-table' => 'assets',
					'parent-primary-key' => 'asset_ID',
					'child-primary-key' => 'call_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Call Logs <span class="hidden child-label-call_logs child-field-caption">(Related Asset)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [0 => 'Call ID', 1 => 'Date/Time Logged:', 2 => 'Logged By:', 3 => 'Client', 4 => 'Related Work Order', 5 => 'Related Asset', 6 => 'Related Invoice', 7 => 'Log Entry'],
					'display-field-names' => [0 => 'call_ID', 1 => 'call_datetime', 2 => 'call_loggedby', 3 => 'call_client', 4 => 'call_workorder', 5 => 'call_asset', 6 => 'call_invoice', 7 => 'call_logentry'],
					'sortable-fields' => [0 => '`call_logs`.`call_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => 7, 7 => 8],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-call_logs',
					'template-printable' => 'children-call_logs-printable',
					'query' => "SELECT `call_logs`.`call_ID` as 'call_ID', if(CHAR_LENGTH(`call_logs`.`call_datetime`)>64, concat(left(`call_logs`.`call_datetime`,64),' ...'), `call_logs`.`call_datetime`) as 'call_datetime', if(CHAR_LENGTH(`call_logs`.`call_loggedby`)>64, concat(left(`call_logs`.`call_loggedby`,64),' ...'), `call_logs`.`call_loggedby`) as 'call_loggedby', IF(    CHAR_LENGTH(`clients1`.`id`) || CHAR_LENGTH(`clients1`.`name`), CONCAT_WS('',   `clients1`.`id`, ' : ', `clients1`.`name`), '') as 'call_client', IF(    CHAR_LENGTH(`workorders1`.`wo_ID`) || CHAR_LENGTH(`workorders1`.`wo_Title`), CONCAT_WS('',   `workorders1`.`wo_ID`, ' : ', `workorders1`.`wo_Title`), '') as 'call_workorder', IF(    CHAR_LENGTH(`assets1`.`asset_ID`) || CHAR_LENGTH(`assets1`.`asset_serial`), CONCAT_WS('',   `assets1`.`asset_ID`, ' : ', `assets1`.`asset_serial`), '') as 'call_asset', IF(    CHAR_LENGTH(`invoice1`.`id`) || CHAR_LENGTH(if(`invoice1`.`date_due`,date_format(`invoice1`.`date_due`,'%d/%m/%Y'),'')), CONCAT_WS('',   `invoice1`.`id`, ' : ', if(`invoice1`.`date_due`,date_format(`invoice1`.`date_due`,'%d/%m/%Y'),'')), '') as 'call_invoice', if(CHAR_LENGTH(`call_logs`.`call_logentry`)>64, concat(left(`call_logs`.`call_logentry`,64),' ...'), `call_logs`.`call_logentry`) as 'call_logentry' FROM `call_logs` LEFT JOIN `clients` as clients1 ON `clients1`.`id`=`call_logs`.`call_client` LEFT JOIN `workorders` as workorders1 ON `workorders1`.`wo_ID`=`call_logs`.`call_workorder` LEFT JOIN `assets` as assets1 ON `assets1`.`asset_ID`=`call_logs`.`call_asset` LEFT JOIN `invoice` as invoice1 ON `invoice1`.`id`=`call_logs`.`call_invoice` "
				],
				'call_invoice' => [
					'parent-table' => 'invoice',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'call_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Call Logs <span class="hidden child-label-call_logs child-field-caption">(Related Invoice)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [0 => 'Call ID', 1 => 'Date/Time Logged:', 2 => 'Logged By:', 3 => 'Client', 4 => 'Related Work Order', 5 => 'Related Asset', 6 => 'Related Invoice', 7 => 'Log Entry'],
					'display-field-names' => [0 => 'call_ID', 1 => 'call_datetime', 2 => 'call_loggedby', 3 => 'call_client', 4 => 'call_workorder', 5 => 'call_asset', 6 => 'call_invoice', 7 => 'call_logentry'],
					'sortable-fields' => [0 => '`call_logs`.`call_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => 7, 7 => 8],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-call_logs',
					'template-printable' => 'children-call_logs-printable',
					'query' => "SELECT `call_logs`.`call_ID` as 'call_ID', if(CHAR_LENGTH(`call_logs`.`call_datetime`)>64, concat(left(`call_logs`.`call_datetime`,64),' ...'), `call_logs`.`call_datetime`) as 'call_datetime', if(CHAR_LENGTH(`call_logs`.`call_loggedby`)>64, concat(left(`call_logs`.`call_loggedby`,64),' ...'), `call_logs`.`call_loggedby`) as 'call_loggedby', IF(    CHAR_LENGTH(`clients1`.`id`) || CHAR_LENGTH(`clients1`.`name`), CONCAT_WS('',   `clients1`.`id`, ' : ', `clients1`.`name`), '') as 'call_client', IF(    CHAR_LENGTH(`workorders1`.`wo_ID`) || CHAR_LENGTH(`workorders1`.`wo_Title`), CONCAT_WS('',   `workorders1`.`wo_ID`, ' : ', `workorders1`.`wo_Title`), '') as 'call_workorder', IF(    CHAR_LENGTH(`assets1`.`asset_ID`) || CHAR_LENGTH(`assets1`.`asset_serial`), CONCAT_WS('',   `assets1`.`asset_ID`, ' : ', `assets1`.`asset_serial`), '') as 'call_asset', IF(    CHAR_LENGTH(`invoice1`.`id`) || CHAR_LENGTH(if(`invoice1`.`date_due`,date_format(`invoice1`.`date_due`,'%d/%m/%Y'),'')), CONCAT_WS('',   `invoice1`.`id`, ' : ', if(`invoice1`.`date_due`,date_format(`invoice1`.`date_due`,'%d/%m/%Y'),'')), '') as 'call_invoice', if(CHAR_LENGTH(`call_logs`.`call_logentry`)>64, concat(left(`call_logs`.`call_logentry`,64),' ...'), `call_logs`.`call_logentry`) as 'call_logentry' FROM `call_logs` LEFT JOIN `clients` as clients1 ON `clients1`.`id`=`call_logs`.`call_client` LEFT JOIN `workorders` as workorders1 ON `workorders1`.`wo_ID`=`call_logs`.`call_workorder` LEFT JOIN `assets` as assets1 ON `assets1`.`asset_ID`=`call_logs`.`call_asset` LEFT JOIN `invoice` as invoice1 ON `invoice1`.`id`=`call_logs`.`call_invoice` "
				],
			],
			'call_notes' => [
				'callnote_call' => [
					'parent-table' => 'call_logs',
					'parent-primary-key' => 'call_ID',
					'child-primary-key' => 'callnote_ID',
					'child-primary-key-index' => 1,
					'tab-label' => 'Call Notes <span class="hidden child-label-call_notes child-field-caption">(Related Call: )</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [0 => 'Related Call: ', 1 => 'Note ID', 2 => 'Note Logged: ', 3 => 'Logged By:', 4 => 'Call Notes'],
					'display-field-names' => [0 => 'callnote_call', 1 => 'callnote_ID', 2 => 'callnote_datetime', 3 => 'callnote_loggedby', 4 => 'callnote_note'],
					'sortable-fields' => [0 => 1, 1 => '`call_notes`.`callnote_ID`', 2 => 3, 3 => 4, 4 => 5],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-call_notes',
					'template-printable' => 'children-call_notes-printable',
					'query' => "SELECT IF(    CHAR_LENGTH(`call_logs1`.`call_ID`) || CHAR_LENGTH(`call_logs1`.`call_datetime`), CONCAT_WS('',   `call_logs1`.`call_ID`, ' : ', `call_logs1`.`call_datetime`), '') as 'callnote_call', `call_notes`.`callnote_ID` as 'callnote_ID', if(CHAR_LENGTH(`call_notes`.`callnote_datetime`)>64, concat(left(`call_notes`.`callnote_datetime`,64),' ...'), `call_notes`.`callnote_datetime`) as 'callnote_datetime', if(CHAR_LENGTH(`call_notes`.`callnote_loggedby`)>64, concat(left(`call_notes`.`callnote_loggedby`,64),' ...'), `call_notes`.`callnote_loggedby`) as 'callnote_loggedby', if(CHAR_LENGTH(`call_notes`.`callnote_note`)>128, concat(left(`call_notes`.`callnote_note`,128),' ...'), `call_notes`.`callnote_note`) as 'callnote_note' FROM `call_notes` LEFT JOIN `call_logs` as call_logs1 ON `call_logs1`.`call_ID`=`call_notes`.`callnote_call` "
				],
			],
			'supportcase' => [
				'case_call' => [
					'parent-table' => 'call_logs',
					'parent-primary-key' => 'call_ID',
					'child-primary-key' => 'case_ID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Support Cases <span class="hidden child-label-supportcase child-field-caption">(Related Call)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [1 => 'Case Number', 2 => 'Status', 3 => 'Client', 4 => 'Related Call', 5 => 'Date/Time Opened: ', 6 => 'Opened By: ', 7 => 'External/Vendor Ticket Dispatch Number', 8 => 'Subject/Short Description', 9 => 'Case description'],
					'display-field-names' => [1 => 'case_number', 2 => 'case_status', 3 => 'case_client', 4 => 'case_call', 5 => 'case_datetime', 6 => 'case_openedby', 7 => 'case_external', 8 => 'case_subject', 9 => 'case_description'],
					'sortable-fields' => [0 => '`supportcase`.`case_ID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => 7, 7 => 8, 8 => 9, 9 => 10],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-supportcase',
					'template-printable' => 'children-supportcase-printable',
					'query' => "SELECT `supportcase`.`case_ID` as 'case_ID', if(CHAR_LENGTH(`supportcase`.`case_number`)>64, concat(left(`supportcase`.`case_number`,64),' ...'), `supportcase`.`case_number`) as 'case_number', if(CHAR_LENGTH(`supportcase`.`case_status`)>64, concat(left(`supportcase`.`case_status`,64),' ...'), `supportcase`.`case_status`) as 'case_status', IF(    CHAR_LENGTH(`clients1`.`id`) || CHAR_LENGTH(`clients1`.`name`), CONCAT_WS('',   `clients1`.`id`, ' : ', `clients1`.`name`), '') as 'case_client', IF(    CHAR_LENGTH(`call_logs1`.`call_ID`) || CHAR_LENGTH(`call_logs1`.`call_datetime`), CONCAT_WS('',   `call_logs1`.`call_ID`, ' : ', `call_logs1`.`call_datetime`), '') as 'case_call', if(CHAR_LENGTH(`supportcase`.`case_datetime`)>64, concat(left(`supportcase`.`case_datetime`,64),' ...'), `supportcase`.`case_datetime`) as 'case_datetime', if(CHAR_LENGTH(`supportcase`.`case_openedby`)>64, concat(left(`supportcase`.`case_openedby`,64),' ...'), `supportcase`.`case_openedby`) as 'case_openedby', if(CHAR_LENGTH(`supportcase`.`case_external`)>64, concat(left(`supportcase`.`case_external`,64),' ...'), `supportcase`.`case_external`) as 'case_external', if(CHAR_LENGTH(`supportcase`.`case_subject`)>128, concat(left(`supportcase`.`case_subject`,128),' ...'), `supportcase`.`case_subject`) as 'case_subject', if(CHAR_LENGTH(`supportcase`.`case_description`)>128, concat(left(`supportcase`.`case_description`,128),' ...'), `supportcase`.`case_description`) as 'case_description' FROM `supportcase` LEFT JOIN `clients` as clients1 ON `clients1`.`id`=`supportcase`.`case_client` LEFT JOIN `call_logs` as call_logs1 ON `call_logs1`.`call_ID`=`supportcase`.`case_call` "
				],
			],
			'supportcase_notes' => [
				'sc_notecase' => [
					'parent-table' => 'supportcase',
					'parent-primary-key' => 'case_ID',
					'child-primary-key' => 'sc_noteID',
					'child-primary-key-index' => 0,
					'tab-label' => 'Activity Stream <span class="hidden child-label-supportcase_notes child-field-caption">(Related Case)</span>',
					'auto-close' => true,
					'table-icon' => 'table.gif',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => [0 => 'Event ID', 1 => 'Created on:', 2 => 'Created By: ', 3 => 'Related Case', 4 => 'Details'],
					'display-field-names' => [0 => 'sc_noteID', 1 => 'sc_notedatetime', 2 => 'sc_noteauthor', 3 => 'sc_notecase', 4 => 'sc_notedetails'],
					'sortable-fields' => [0 => '`supportcase_notes`.`sc_noteID`', 1 => 2, 2 => 3, 3 => 4, 4 => 5],
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-supportcase_notes',
					'template-printable' => 'children-supportcase_notes-printable',
					'query' => "SELECT `supportcase_notes`.`sc_noteID` as 'sc_noteID', if(CHAR_LENGTH(`supportcase_notes`.`sc_notedatetime`)>64, concat(left(`supportcase_notes`.`sc_notedatetime`,64),' ...'), `supportcase_notes`.`sc_notedatetime`) as 'sc_notedatetime', if(CHAR_LENGTH(`supportcase_notes`.`sc_noteauthor`)>64, concat(left(`supportcase_notes`.`sc_noteauthor`,64),' ...'), `supportcase_notes`.`sc_noteauthor`) as 'sc_noteauthor', IF(    CHAR_LENGTH(`supportcase1`.`case_number`) || CHAR_LENGTH(`supportcase1`.`case_subject`), CONCAT_WS('',   `supportcase1`.`case_number`, ' : ', `supportcase1`.`case_subject`), '') as 'sc_notecase', if(CHAR_LENGTH(`supportcase_notes`.`sc_notedetails`)>128, concat(left(`supportcase_notes`.`sc_notedetails`,128),' ...'), `supportcase_notes`.`sc_notedetails`) as 'sc_notedetails' FROM `supportcase_notes` LEFT JOIN `supportcase` as supportcase1 ON `supportcase1`.`case_ID`=`supportcase_notes`.`sc_notecase` "
				],
			],
		];

	/*************************************/
	/* End of configuration */


	include_once(__DIR__ . '/lib.php');
	@header('Content-Type: text/html; charset=' . datalist_db_encoding);

	handle_maintenance();

	/**
	* dynamic configuration based on current user's permissions
	* $userPCConfig array is populated only with parent tables where the user has access to
	* at least one child table
	*/
	$userPCConfig = [];
	foreach($pcConfig as $pcChildTable => $ChildrenLookups) {
		$permChild = getTablePermissions($pcChildTable);
		if(!$permChild['view']) continue;

		foreach($ChildrenLookups as $ChildLookupField => $ChildConfig) {
			$permParent = getTablePermissions($ChildConfig['parent-table']);
			if(!$permParent['view']) continue;

			$userPCConfig[$pcChildTable][$ChildLookupField] = $pcConfig[$pcChildTable][$ChildLookupField];
			// show add new only if configured above AND the user has insert permission
			$userPCConfig[$pcChildTable][$ChildLookupField]['display-add-new'] = ($permChild['insert'] && $pcConfig[$pcChildTable][$ChildLookupField]['display-add-new']);
		}
	}

	/* Receive, UTF-convert, and validate parameters */
	$ParentTable = Request::val('ParentTable'); // needed only with operation=show-children, will be validated in the processing code
	$ChildTable = Request::val('ChildTable');
		if(!in_array($ChildTable, array_keys($userPCConfig))) {
			/* defaults to first child table in config array if not provided */
			$ChildTable = current(array_keys($userPCConfig));
		}
		if(!$ChildTable) { die('<!-- No tables accessible to current user -->'); }
	$SelectedID = strip_tags(Request::val('SelectedID'));
	$ChildLookupField = Request::val('ChildLookupField');
		if(!in_array($ChildLookupField, array_keys($userPCConfig[$ChildTable]))) {
			/* defaults to first lookup in current child config array if not provided */
			$ChildLookupField = current(array_keys($userPCConfig[$ChildTable]));
		}

	if(function_exists('child_records_config')) {
		// $userPCConfig is passed by reference
		child_records_config($ChildTable, $ChildLookupField, $userPCConfig);
	}

	$currentConfig = $userPCConfig[$ChildTable][$ChildLookupField];
	if(empty($currentConfig))
		die('<!-- No tables accessible to current user -->');

	$Page = intval(Request::val('Page'));
		if($Page < 1) $Page = 1;
	$SortBy = (Request::val('SortBy') != '' ? abs(intval(Request::val('SortBy'))) : false);
		if(!in_array($SortBy, array_keys($currentConfig['sortable-fields']), true))
			$SortBy = $currentConfig['default-sort-by'];
	$SortDirection = strtolower(Request::val('SortDirection'));
		if(!in_array($SortDirection, ['asc', 'desc']))
			$SortDirection = $currentConfig['default-sort-direction'];
	$Operation = strtolower(Request::val('Operation'));
		if(!in_array($Operation, ['get-records', 'show-children', 'get-records-printable', 'show-children-printable']))
			$Operation = 'get-records';

	/* process requested operation */
	switch($Operation) {
		/************************************************/
		case 'show-children':
			/* populate HTML and JS content with children tabs */
			$tabLabels = $tabPanels = $tabLoaders = '';
			foreach($userPCConfig as $ChildTable => $childLookups) {
				foreach($childLookups as $ChildLookupField => $childConfig) {
					if($childConfig['parent-table'] != $ParentTable) continue;

					$TableIcon = ($childConfig['table-icon'] ? "<img src=\"{$childConfig['table-icon']}\" border=\"0\">" : '');

					$tabLabels .= "<li class=\"child-tab-label child-table-{$ChildTable} lookup-field-{$ChildLookupField} " . ($tabLabels ? '' : 'active') . "\">" .
							"<a href=\"#panel_{$ChildTable}-{$ChildLookupField}\" id=\"tab_{$ChildTable}-{$ChildLookupField}\" data-toggle=\"tab\">" .
								$TableIcon . $childConfig['tab-label'] .
								"<span class=\"badge child-count child-count-{$ChildTable}-{$ChildLookupField}\"></span>" .
							"</a>" .
						"</li>\n\t\t\t\t";

					$tabPanels .= "<div id=\"panel_{$ChildTable}-{$ChildLookupField}\" class=\"tab-pane" . ($tabPanels ? '' : ' active') . "\">" .
							"<i class=\"glyphicon glyphicon-refresh loop-rotate\"></i> " .
							"{$Translation['Loading ...']}" .
						"</div>\n\t\t\t\t";

					$tabLoaders .= "post('parent-children.php', " . json_encode([
							'ChildTable' => $ChildTable,
							'ChildLookupField' => $ChildLookupField,
							'SelectedID' => $SelectedID,
							'Page' => 1,
							'SortBy' => '',
							'SortDirection' => '',
							'Operation' => 'get-records'
						]) . ", 'panel_{$ChildTable}-{$ChildLookupField}');\n\t\t\t\t";
				}
			}

			if(!$tabLabels) { die('<!-- no children of current parent table are accessible to current user -->'); }
			?>
			<div id="children-tabs">
				<ul class="nav nav-tabs">
					<?php echo $tabLabels; ?>
				</ul>
				<span id="pc-loading"></span>
			</div>
			<div class="tab-content"><?php echo $tabPanels; ?></div>

			<script>
				$j(function() {
					/* for iOS, avoid loading child tabs in modals */
					var iOS = /(iPad|iPhone|iPod)/g.test(navigator.userAgent);
					var embedded = ($j('.navbar').length == 0);
					if(iOS && embedded) {
						$j('#children-tabs').next('.tab-content').remove();
						$j('#children-tabs').remove();
						return;
					}

					/* ajax loading of each tab's contents */
					<?php echo $tabLoaders; ?>

					/* show child field caption on tab title in case the same child table appears more than once */
					$j('.child-field-caption').each(function() {
						var clss = $j(this).attr('class').split(/\s+/).reduce(function(rc, cc) {
							return (cc.match(/child-label-.*/) ? '.' + cc : rc);
						}, '');

						// if class occurs more than once, remove .hidden
						if($j(clss).length > 1) $j(clss).removeClass('hidden');
					})
				})
			</script>
			<?php
			break;

		/************************************************/
		case 'show-children-printable':
			/* populate HTML and JS content with children buttons */
			$tabLabels = $tabPanels = $tabLoaders = '';
			foreach($userPCConfig as $ChildTable => $childLookups) {
				foreach($childLookups as $ChildLookupField => $childConfig) {
					if($childConfig['parent-table'] != $ParentTable) continue;

					$TableIcon = ($childConfig['table-icon'] ? "<img src=\"{$childConfig['table-icon']}\" border=\"0\">" : '');

					$tabLabels .= "<button type=\"button\" class=\"btn btn-default child-tab-print-toggler\" data-target=\"#panel_{$ChildTable}-{$ChildLookupField}\" id=\"tab_{$ChildTable}-{$ChildLookupField}\" data-toggle=\"collapse\">" .
							"{$TableIcon} {$childConfig['tab-label']}" .
							"<span class=\"badge child-count child-count-{$ChildTable}-{$ChildLookupField}\"></span>" .
						"</button>\n\t\t\t\t\t";

					$tabPanels .= "<div id=\"panel_{$ChildTable}-{$ChildLookupField}\" class=\"collapse child-panel-print\">" .
							"<i class=\"glyphicon glyphicon-refresh loop-rotate\"></i> " .
							$Translation['Loading ...'] .
						"</div>\n\t\t\t\t";

					$tabLoaders .= "post('parent-children.php', " . json_encode([
							'ChildTable' => $ChildTable,
							'ChildLookupField' => $ChildLookupField,
							'SelectedID' => $SelectedID,
							'Page' => 1,
							'SortBy' => '',
							'SortDirection' => '',
							'Operation' => 'get-records-printable'
						]) . ", 'panel_{$ChildTable}-{$ChildLookupField}');\n\t\t\t\t";
				}
			}

			if(!$tabLabels) { die('<!-- no children of current parent table are accessible to current user -->'); }
			?>
			<div id="children-tabs" class="hidden-print">
				<div class="btn-group btn-group-lg">
					<?php echo $tabLabels; ?>
				</div>
				<span id="pc-loading"></span>
			</div>
			<div class="vspacer-lg"><?php echo $tabPanels; ?></div>

			<script>
				$j(function() {
					/* for iOS, avoid loading child tabs in modals */
					var iOS = /(iPad|iPhone|iPod)/g.test(navigator.userAgent);
					var embedded = ($j('.navbar').length == 0);
					if(iOS && embedded) {
						$j('#children-tabs').next('.tab-content').remove();
						$j('#children-tabs').remove();
						return;
					}

					/* ajax loading of each tab's contents */
					<?php echo $tabLoaders; ?>
				})
			</script>
			<?php
			break;

		/************************************************/
		case 'get-records-printable':
		default: /* default is 'get-records' */

			if($Operation == 'get-records-printable') {
				$currentConfig['records-per-page'] = 2000;
			}

			// build the user permissions limiter
			$permissionsWhere = $permissionsJoin = '';
			$permChild = getTablePermissions($ChildTable);
			if($permChild['view'] == 1) { // user can view only his own records
				$permissionsWhere = "`$ChildTable`.`{$currentConfig['child-primary-key']}`=`membership_userrecords`.`pkValue` AND `membership_userrecords`.`tableName`='$ChildTable' AND LCASE(`membership_userrecords`.`memberID`)='" . getLoggedMemberID() . "'";
			} elseif($permChild['view'] == 2) { // user can view only his group's records
				$permissionsWhere = "`$ChildTable`.`{$currentConfig['child-primary-key']}`=`membership_userrecords`.`pkValue` AND `membership_userrecords`.`tableName`='$ChildTable' AND `membership_userrecords`.`groupID`='" . getLoggedGroupID() . "'";
			} elseif($permChild['view'] == 3) { // user can view all records
				/* that's the only case remaining ... no need to modify the query in this case */
			}
			$permissionsJoin = ($permissionsWhere ? ", `membership_userrecords`" : '');

			// build the count query
			$forcedWhere = $currentConfig['forced-where'];
			$query = 
				preg_replace('/^select .* from /i', 'SELECT count(1) FROM ', $currentConfig['query']) .
				$permissionsJoin . " WHERE " .
				($permissionsWhere ? "( $permissionsWhere )" : "( 1=1 )") . " AND " .
				($forcedWhere ? "( $forcedWhere )" : "( 2=2 )") . " AND " .
				"`$ChildTable`.`$ChildLookupField`='" . makeSafe($SelectedID) . "'";
			$totalMatches = sqlValue($query);

			// make sure $Page is <= max pages
			$maxPage = ceil($totalMatches / $currentConfig['records-per-page']);
			if($Page > $maxPage) { $Page = $maxPage; }

			// initiate output data array
			$data = [
				'config' => $currentConfig,
				'parameters' => [
					'ChildTable' => $ChildTable,
					'ChildLookupField' => $ChildLookupField,
					'SelectedID' => $SelectedID,
					'Page' => $Page,
					'SortBy' => $SortBy,
					'SortDirection' => $SortDirection,
					'Operation' => $Operation,
				],
				'records' => [],
				'totalMatches' => $totalMatches
			];

			// build the data query
			if($totalMatches) { // if we have at least one record, proceed with fetching data
				$startRecord = $currentConfig['records-per-page'] * ($Page - 1);
				$data['query'] = 
					$currentConfig['query'] .
					$permissionsJoin . " WHERE " .
					($permissionsWhere ? "( $permissionsWhere )" : "( 1=1 )") . " AND " .
					($forcedWhere ? "( $forcedWhere )" : "( 2=2 )") . " AND " .
					"`$ChildTable`.`$ChildLookupField`='" . makeSafe($SelectedID) . "'" . 
					($SortBy !== false && $currentConfig['sortable-fields'][$SortBy] ? " ORDER BY {$currentConfig['sortable-fields'][$SortBy]} $SortDirection" : '') .
					" LIMIT $startRecord, {$currentConfig['records-per-page']}";
				$res = sql($data['query'], $eo);
				while($row = db_fetch_row($res)) {
					$data['records'][$row[$currentConfig['child-primary-key-index']]] = $row;
				}
			} else { // if no matching records
				$startRecord = 0;
			}

			if($Operation == 'get-records-printable') {
				$response = loadView($currentConfig['template-printable'], $data);
			} else {
				$response = loadView($currentConfig['template'], $data);
			}

			// change name space to ensure uniqueness
			$uniqueNameSpace = $ChildTable.ucfirst($ChildLookupField).'GetRecords';
			echo str_replace("{$ChildTable}GetChildrenRecordsList", $uniqueNameSpace, $response);
		/************************************************/
	}
